<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Document</title>
   </head>
   <body>
      <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
      <div style="text-align: center">
         <div id="reader" style="max-width: 100%; height: 100%"></div>
         <div id="show" style="display: none">
            <h4>Scanned Result:</h4>
            <p id="result"></p>
            <h3>Product:</h3>
            <p id="product-result"></p>
         </div>
         <button
            onclick="scanBarcode()"
            style="
               height: 40px;
               width: 100px;
               display: flex;
               align-items: center;
               font-size: 14px;
               column-gap: 6px;
               text-transform: uppercase;
               letter-spacing: 1px;
               background-color: black;
               color: white;
               cursor: pointer;
            "
         >
            <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
               <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M6.75 4.5H3V8.25H4.5V6H6.75V4.5ZM6.75 8.25V15.75H8.25V8.25H6.75ZM9.75 15.75V8.25H11.25V15.75H9.75ZM12.75 8.25V15.75H14.25V8.25H12.75ZM15.75 15.75V8.25H17.25V15.75H15.75ZM17.25 19.5H21V15.75H19.5V18H17.25V19.5ZM3 19.5V15.75H4.5L4.5 18H6.75L6.75 19.5H3ZM21 8.25V4.5H17.25V6H19.5V8.25L21 8.25Z"
                  fill="#fff"
               />
            </svg>
            <p>Scan</p>
         </button>
      </div>
      <script>
         function scanBarcode() {
            const html5QRcode = new Html5Qrcode("reader");
            const qrCodeSuccessCallback = (decodedText, decodedResult) => {
               if (decodedText) {
                  document.getElementById("show").style.display = "block";
                  document.getElementById("result").textContent = decodedText;
                  html5QRcode.stop();
                  fetch(`https://api.au-aws.thewishlist.io/services/productsvc/api/v2/products/variants/${decodedText}/byBarcode`, {
                     method: "GET",
                     headers: {
                        "x-twc-tenant": "viktoria-woods",
                        "authorization": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJRWlJkS3JabXJmMEk3WkhXRUtqNWRLTEhQanFubWJFeV9iNmpSbHdya1drIn0.eyJleHAiOjE3MTk0OTY2NjAsImlhdCI6MTcxOTQ5NTQ2MCwianRpIjoiMjNlZTkzNDYtNGU0OC00MWQ0LWJjOTMtY2Y0NDhhMmM5ZjA4IiwiaXNzIjoiaHR0cHM6Ly9hdXRoLmF1LWF3cy50aGV3aXNobGlzdC5pby9hdXRoL3JlYWxtcy90d2NNYWluIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjI2YTIyNTAyLWRhNzQtNDhkMC1iZWFiLTgzY2E0YTlmMDdlOSIsInR5cCI6IkJlYXJlciIsImF6cCI6InR3Yy1wb3MtY2xpZW50Iiwic2Vzc2lvbl9zdGF0ZSI6IjQ4OWU1MWQ3LTNlOWUtNGFiMC04MjM5LTM5NGY3MDYyYWZlMiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cHM6Ly9sb2NhbGhvc3QiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbInR3Yy1wb3MtdXNlciIsIm9mZmxpbmVfYWNjZXNzIiwidHdjLXN0b3JlLW93bmVyIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InRlbmFudGlkIHN0b3JlIHByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInRlbmFudGlkIjoidmlrdG9yaWEtd29vZHMiLCJuYW1lIjoiTWF0dCBIYW1wc2hpcmUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJtYXR0QHRoZXdpc2hsaXN0LmlvIiwic3RvcmUiOiIyMDUiLCJnaXZlbl9uYW1lIjoiTWF0dCIsImZhbWlseV9uYW1lIjoiSGFtcHNoaXJlIiwiZW1haWwiOiJtYXR0QHRoZXdpc2hsaXN0LmlvIn0.U4rbStrpNfsCrRuJejiu8bWuwg-C5LZsvrq8dvkymnHwXRl2_TTc95KzJX14YzCQk_Mdf3SsPkqJh_c2Ri-A7T-9v6R4Jy9Q5kcEBycBZNRLuXqh3VEtB5WWaokM28dAxgFS8FA6bLPT7cHBeFzYBMm4nxPP9ZW8E0AVBJ1CuqN8JhatjXFWSDfNBVXczJA3RmKSLE3mh_5xQkrWKbAX3wcSpKIXxLqAmUhgL0QFFnrkUDL5UtrgabyduR_Zez1KOyphjmSIdLv-mcCiUc54IX4BPvvyRgjzJj7CD_Aw5Gn7f-XMC_fgZu1nsOSh3elH3bj5DHSdsCC-85HtDWN9aQ"
                     },
                  })
                     .then((response) => response.json())
                     .then((data) => {
                        document.getElementById("product-result").textContent = JSON.stringify(data);
                     })
                     .catch((error) => {
                        console.error("Error:", error);
                     });
               }
            };

            const config = {
               fps: 10,
               qrbox: { width: 200, height: 100 },
            };
            html5QRcode.start({ facingMode: "environment" }, config, qrCodeSuccessCallback);
         }
      </script>
   </body>
</html>
